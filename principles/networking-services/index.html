<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Networking & Services - Systology</title><meta name=description content="API design, rate limiting, retries, and resilient service communication."><link rel=canonical href=https://sambyte.net/systology/principles/networking-services/><link rel=icon href=/favicon.svg type=image/svg+xml><meta name=robots content="index, follow"><script>try{localStorage.getItem("theme")==="dark"&&document.documentElement.setAttribute("data-theme","dark")}catch{}</script><link rel=stylesheet href="/css/styles.css?v=1772222251"><link rel=stylesheet href="/css/syntax.css?v=1772222251"><link rel=stylesheet href="/css/search.css?v=1772222251"></head><body><header class=site-header role=banner><div class="container header-inner"><a class=brand href=/ aria-label=Systology><img src=/favicon.svg alt class=logo-icon> Systology</a><nav class=site-nav role=navigation aria-label="Main navigation"><button class=search-toggle data-open-search aria-label=Search>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
</button>
<button class=theme-toggle id=theme-toggle aria-label="Toggle dark mode">
<svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></nav></div></header><main id=content class="container prose"><article><header><div class=title-group><h1>Networking & Services</h1></div><h2>API design, rate limiting, retries, and resilient service communication.</h2><div class=tags><span>Tags:</span>
<a class=badge href=/tags/networking/>networking</a></div></header><section><h2 id=api-design--contracts>API Design & Contracts</h2><p>Define clear, versioned API contracts with request/response schemas and use REST conventions or gRPC for performance-critical paths. Explicit contracts prevent misunderstandings and enable independent evolution.</p><p>Start with OpenAPI (Swagger) for REST APIs or Protocol Buffer definitions for gRPC. These schemas serve as the single source of truth‚Äîgenerate client SDKs, server stubs, and documentation from the same spec. Version your API in the URL path (<code>/v1/</code>, <code>/v2/</code>) or via content negotiation headers. When adding fields, make them optional with sensible defaults so existing clients don&rsquo;t break.</p><p>See the <a href=https://sambyte.net/systology/designs/notification-system/>Notification System</a> design for an example of a well-defined internal API with priority routing and channel adapters.</p><p><strong>Anti-pattern ‚Äî Implicit Contracts:</strong> Documenting your API in a README that drifts from the actual implementation. Without a machine-readable schema, clients are built on assumptions that break silently when the server changes. A typo in a field name becomes a production incident. Use contract-first design: write the spec, generate the code.</p><h2 id=error-handling--retries>Error Handling & Retries</h2><p>Implement exponential backoff with jitter for transient failures (5xx, timeouts) but never retry non-retryable errors (4xx). Cap retries to prevent infinite loops and differentiate error types to avoid wasted effort.</p><p>Use a standard formula: <code>delay = min(base * 2^attempt + random_jitter, max_delay)</code>. Start at 1s, cap at 60s, add ¬±25% jitter to prevent thundering herd when many clients retry simultaneously. Classify errors: 429 (rate limited) ‚Üí retry with the <code>Retry-After</code> header; 500/502/503 ‚Üí retry with backoff; 400/401/403/404 ‚Üí do not retry (fix the request).</p><p>See <a href=https://sambyte.net/systology/deep-dives/photohaul/>Photohaul</a> for an example of handling exponential backoff and retries when dealing with cloud storage API rate limits.</p><p><strong>Anti-pattern ‚Äî Retry Storms:</strong> Retrying immediately without backoff or jitter. When a service is overloaded and returns 503, 1000 clients immediately retrying at the same instant creates a thundering herd that prevents recovery. Exponential backoff with jitter spreads retries across time, giving the service room to recover.</p><p><strong>Anti-pattern ‚Äî Retrying Non-retryable Errors:</strong> Retrying a 400 Bad Request. The request is malformed; sending it again won&rsquo;t fix it. You burn resources, fill logs with identical errors, and delay the real fix (correcting the request). Classify errors before retrying.</p><h2 id=rate-limiting--throttling>Rate Limiting & Throttling</h2><p>Respect external rate limits with adaptive throttling and implement client-side rate limiting to avoid overwhelming downstream services. Token bucket algorithms provide smooth traffic shaping.</p><p>Implement both client-side and server-side rate limiting. Client-side: use a token bucket that tracks your API quota and blocks requests proactively before hitting the server. Server-side: return <code>429 Too Many Requests</code> with a <code>Retry-After</code> header. For adaptive throttling, track recent 429 responses and reduce request rate proportionally‚Äîlike TCP congestion control for APIs.</p><p>See the <a href=https://sambyte.net/systology/designs/flash-sale/>Flash Sale</a> design for production-grade rate limiting and connection shedding at extreme scale (1M concurrent users).</p><p><strong>Anti-pattern ‚Äî Ignoring Rate Limits:</strong> Treating 429 responses as transient errors and retrying immediately at full speed. This escalates to IP bans, API key revocation, and provider relationship damage. Parse the <code>Retry-After</code> header and back off accordingly.</p><h2 id=timeouts--deadlines>Timeouts & Deadlines</h2><p>Set appropriate timeouts (connection, read, total) and propagate deadlines across service boundaries for coordinated cancellation. Timeouts prevent indefinite hangs; deadlines ensure requests fail consistently.</p><p>Use three timeout layers: connection timeout (how long to wait for TCP handshake, ~3s), read timeout (how long to wait for response data, ~10s), and total timeout (end-to-end including retries, ~30s). For service-to-service calls, propagate deadlines: if the API gateway has 5s remaining on its deadline, pass <code>deadline: now + 4.5s</code> to the downstream service so it can abort early rather than doing work that will be discarded.</p><p><strong>Anti-pattern ‚Äî No Timeout:</strong> Making HTTP requests without timeouts. A downstream service hangs, your thread pool fills up, your service stops responding, your upstream callers time out and retry, creating cascading failure. Every network call must have a timeout. Every. Single. One.</p><h2 id=connection-management>Connection Management</h2><p>Use connection pooling to avoid repeated handshake overhead and implement keep-alive for reuse. Pool size matters: too small causes queueing, too large wastes resources.</p><p>Configure pool size based on expected concurrency: for a service making 100 concurrent requests to a downstream, a pool of 100 connections avoids queueing. But 1000 connections to a database that only handles 100 concurrent queries wastes file descriptors and causes server-side contention. Use health checks on pooled connections to evict stale or broken sockets. For HTTP/2 or gRPC, multiplexing multiple streams over a single connection reduces the need for large connection pools.</p><p><strong>Anti-pattern ‚Äî Connection Per Request:</strong> Opening a new TCP connection (with TLS handshake) for every HTTP request. TLS negotiation alone adds 1‚Äì3 round trips (~50‚Äì150ms). At 1000 requests/second, that&rsquo;s 1000 unnecessary handshakes. Pool and reuse connections.</p><h2 id=service-discovery--load-balancing>Service Discovery & Load Balancing</h2><p>Use service discovery (DNS, Kubernetes services) for dynamic endpoints and implement health-check-based routing. Load balancing reduces tail latency better than round-robin alone.</p><p>In Kubernetes, services provide built-in L4 load balancing. For more intelligent routing, use an L7 load balancer (Envoy, NGINX) with health-check-based routing that removes unhealthy backends and least-connections balancing that sends traffic to the least loaded instance. For client-side load balancing (common in gRPC), maintain a local service registry and use weighted round-robin with health checks.</p><p><strong>Anti-pattern ‚Äî Hardcoded Endpoints:</strong> Configuring downstream service URLs as static strings (<code>api.internal.company.com:8080</code>). When the service moves, scales, or fails over, your config requires a manual update and restart. Use service discovery for dynamic resolution and health-aware routing.</p><h2 id=authentication--authorization>Authentication & Authorization</h2><p>Use OAuth 2.0 flows for third-party integrations and implement token refresh logic with secure credential storage. Apply least privilege for service-to-service auth.</p><p>For user-facing APIs, use OAuth 2.0 with PKCE (for public clients) or client credentials (for server-to-server). Store tokens in OS keychains or encrypted config, never in plaintext files or environment variables visible in process listings. Implement automatic token refresh with jitter to prevent synchronized refresh storms. For service-to-service auth, use mutual TLS (mTLS) or signed JWTs with short expiration.</p><p>See <a href=https://sambyte.net/systology/deep-dives/mailprune/>Mailprune</a> for an example of implementing OAuth 2.0 flows with local secure credential storage for an email processing agent. For broader guidance on token and credential safety in automated systems, see the <a href=https://sambyte.net/systology/principles/privacy-agents/>Privacy & Agents</a> principles.</p><p><strong>Anti-pattern ‚Äî Long-lived API Keys:</strong> Using a single API key with no rotation that has admin-level access. If the key leaks (and it will‚Äîin logs, configs, error messages), the blast radius is maximum. Use short-lived tokens with automatic rotation and scope permissions to the minimum required.</p><h2 id=data-serialization--formats>Data Serialization & Formats</h2><p>Choose formats based on tradeoffs: JSON for human debugging, Protocol Buffers for efficiency. Plan for schema evolution with backward/forward compatibility.</p><p>JSON is human-readable, universally supported, and debug-friendly‚Äîideal for public APIs and configuration. Protocol Buffers (protobuf) are binary, strongly typed, and 3‚Äì10x smaller than JSON‚Äîideal for high-throughput internal services. For message queues, Avro provides schema evolution with a registry. Whichever you choose, plan for schema evolution: add fields as optional, never reuse field numbers, and maintain a compatibility policy.</p><p><strong>Anti-pattern ‚Äî Custom Binary Format:</strong> Inventing a bespoke binary serialization format &ldquo;for performance.&rdquo; You spend months debugging encoding edge cases, building tooling, and onboarding teammates. Protobuf, FlatBuffers, and Cap&rsquo;n Proto have already solved this‚Äîuse them.</p><h2 id=async--non-blocking-io>Async & Non-blocking IO</h2><p>Use async/await patterns for scalability and avoid blocking operations in critical paths. Backpressure handling prevents memory exhaustion under load.</p><p>Async IO shines for workloads with many concurrent connections where most time is spent waiting for IO (network, disk). A single async thread can handle thousands of concurrent connections where a thread-per-connection model would exhaust memory. In Python, use <code>asyncio</code>/<code>aiohttp</code>; in Rust, use <code>tokio</code>; in Go, goroutines provide lightweight concurrency natively.</p><p><strong>Anti-pattern ‚Äî Async Everything:</strong> Making CPU-bound work async. Async IO helps when threads are waiting on network responses; for CPU-intensive computation (compression, hashing, ML inference), async provides no benefit and adds complexity. Use thread pools for CPU-bound work and async for IO-bound work.</p><h2 id=ssltls--security>SSL/TLS & Security</h2><p>Enforce HTTPS/TLS and validate certificates with pinning where needed. Keep TLS libraries current as new attacks emerge.</p><p>Use TLS 1.3 (faster handshake, stronger security) and disable TLS 1.0/1.1. Configure HSTS headers to prevent downgrade attacks. For internal service communication, implement mTLS where both client and server verify each other&rsquo;s certificates. Automate certificate rotation with tools like cert-manager (Kubernetes) or Let&rsquo;s Encrypt.</p><p>See the <a href=https://sambyte.net/systology/principles/webapp/>Web App</a> principles for related guidance on HTTPS, CSP, and secure headers in web application contexts.</p><p><strong>Anti-pattern ‚Äî Self-signed Certs with Verification Disabled:</strong> Using <code>verify=False</code> in development and accidentally shipping it to production. This completely negates TLS by accepting any certificate, including man-in-the-middle attacks. Use proper CA-signed certificates in all environments and never disable verification.</p><h2 id=idempotency>Idempotency</h2><p>Design operations to be idempotent using idempotency keys and unique request IDs. Retries are only safe if they can&rsquo;t cause side effects.</p><p>Generate a unique idempotency key per logical operation (UUID or deterministic hash of the operation parameters). Send it with each request. The server checks a short-lived store (Redis with 15-minute TTL) for the key: if found, return the cached response; if not, process the request and cache the result. This makes retries safe for state-changing operations like payments and order creation.</p><p>See the <a href=https://sambyte.net/systology/designs/payment-system/>Payment System</a> design for a production-grade implementation of idempotency in financial transactions.</p><p><strong>Anti-pattern ‚Äî POST Without Idempotency:</strong> Using POST for state-changing operations without idempotency keys. A network timeout causes the client to retry, and the server processes the request twice‚Äîcreating duplicate orders, double-charging a credit card, or sending duplicate notifications. Idempotency keys are cheap insurance against expensive duplicates.</p><h2 id=monitoring--debugging>Monitoring & Debugging</h2><p>Log request/response metadata (status codes, latencies) and emit metrics for success/failure rates. Distributed tracing reveals cross-service latency problems.</p><p>For every outbound HTTP call, log: method, URL (without query params containing secrets), status code, and duration. Emit metrics: <code>http_client_requests_total{method, host, status}</code> and <code>http_client_request_duration_seconds{method, host}</code>. Use these to build dashboards that show error rates and latency percentiles per downstream dependency.</p><p>See the <a href=https://sambyte.net/systology/principles/monitoring/>Monitoring & Observability</a> principles for comprehensive guidance on structured logging, tracing, and alerting.</p><h2 id=local-development--mocking>Local Development & Mocking</h2><p>Provide mock servers and environment-based config to switch backends. Integration tests validate contract compliance without external dependencies.</p><p>Use tools like WireMock (Java), <code>responses</code> (Python), or <code>nock</code> (Node.js) to stub external APIs in tests. For local development, provide a Docker Compose setup that spins up mock versions of downstream services. Use environment-based configuration to switch between real and mock backends: <code>PAYMENT_SERVICE_URL=http://localhost:8081</code> in development vs. the real endpoint in production.</p><p><strong>Anti-pattern ‚Äî Testing Against Production APIs:</strong> Running integration tests against real external services. This is slow, flaky (dependent on external availability), expensive (some APIs charge per call), and dangerous (you might accidentally create real orders or send real notifications). Use mocks and contract tests locally, and reserve real API testing for a staging environment with sandboxed accounts.</p><h2 id=network-resilience>Network Resilience</h2><p>Implement graceful degradation when optional services fail and use fallbacks and caching for reliability. Test failure scenarios regularly‚Äîsurprises belong in labs, not production.</p><p>Use the circuit breaker pattern: after N consecutive failures to a downstream service, open the circuit (stop making requests) for a cooldown period, then half-open (try a single request) to see if recovery has occurred. During the open state, serve from cache, return a degraded response, or surface &ldquo;temporarily unavailable&rdquo; to the user rather than timing out on every request.</p><p>See the <a href=https://sambyte.net/systology/designs/distributed-cache/>Distributed Cache</a> design for how caching provides resilience layers alongside performance.</p><p><strong>Anti-pattern ‚Äî All-or-Nothing Dependency:</strong> Treating every downstream service as critical. If the recommendation service is down, should the entire product page fail? Usually not‚Äîshow the product without recommendations. Classify dependencies as critical (payment must succeed) vs. optional (recommendations are nice-to-have) and degrade gracefully for optional ones.</p><h2 id=decision-framework>Decision Framework</h2><p>Choose your networking protocol based on the latency and reliability requirements of the communication:</p><table><thead><tr><th style=text-align:left>If you need&mldr;</th><th style=text-align:left>&mldr;choose this</th><th style=text-align:left>because&mldr;</th></tr></thead><tbody><tr><td style=text-align:left><strong>High-Throughput</strong></td><td style=text-align:left>gRPC (HTTP/2)</td><td style=text-align:left>Binary serialization and multiplexing reduce overhead.</td></tr><tr><td style=text-align:left><strong>Wide Compatibility</strong></td><td style=text-align:left>REST (HTTP/1.1)</td><td style=text-align:left>Easiest for browser and external partner integration.</td></tr><tr><td style=text-align:left><strong>Real-time Events</strong></td><td style=text-align:left>WebSockets</td><td style=text-align:left>Persistent duplex connection for instant updates.</td></tr><tr><td style=text-align:left><strong>Resilient Retries</strong></td><td style=text-align:left>Service Mesh</td><td style=text-align:left>Offloads retry, timeout, and circuit breaking from app code.</td></tr></tbody></table><p><strong>Decision Heuristic:</strong> &ldquo;Choose <strong>gRPC</strong> for internal service-to-service calls and <strong>REST</strong> for public-facing edge APIs.&rdquo;</p></section><aside class=related><h3>Related</h3><ul><li><a href=/systology/designs/background-job-queue/>Background Job Queue for Big Tasks</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Asynchronous job queue design for resource-heavy tasks (video encoding, data processing) with retries, idempotency, DLQ handling, and autoscaling.</small></li><li><a href=/systology/deep-dives/chowist/>Chowist</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Monolithic Django app for place listings; focus on production hardening: static serving, background jobs, connection pooling, and CI/CD.</small></li><li><a href=/systology/designs/web-crawler/>Distributed Web Crawler</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Design for a Google-scale web crawler focusing on Breadth-First Search (BFS), DNS resolution caching, robots.txt politeness, and handling duplicate or malicious domains.</small></li><li><a href=/systology/designs/migration-dedup/>End-to-End Migration & Deduplication</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>System design for migrating large datasets with deduplication, integrity checks, resumability, and idempotence.</small></li></ul></aside></article></main><footer class=site-footer role=contentinfo><div class="container footer-inner"><p class=copyright>&copy; 2026 Systology. All rights reserved.</p><div class=social-links><a href=https://github.com/huangsam target=_blank rel="noopener noreferrer" aria-label=GitHub><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=http://linkedin.com/in/sambyte target=_blank rel="noopener noreferrer" aria-label=LinkedIn><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></div></div></footer><div id=site-search-modal class=site-search-modal-container style=display:none><div class=site-search-overlay data-close-search></div><div class=site-search-modal><div class=site-search-header><div class=site-search-input-wrapper><span class=site-search-icon><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
</span><input type=text class=site-search-input id=site-search-input placeholder="Search designs, principles, deep dives..." aria-label=Search autocomplete=off>
<button class=site-search-close data-close-search>&#215;</button></div></div><div class=site-search-body><div id=site-search-default class=site-search-default><div class=site-search-quick-links><a href=/categories/ class=site-search-cta><span class=site-search-cta-icon>üìÇ</span>
<span class=site-search-cta-text>All Categories</span>
<span class=site-search-cta-arrow>‚Üí</span>
</a><a href=/tags/ class=site-search-cta><span class=site-search-cta-icon>üè∑Ô∏è</span>
<span class=site-search-cta-text>All Tags</span>
<span class=site-search-cta-arrow>‚Üí</span></a></div></div><div id=site-search-results-list style=display:none></div></div></div></div><script>document.addEventListener("DOMContentLoaded",function(){let i=null,o=null;const t=document.getElementById("site-search-modal"),n=document.getElementById("site-search-input"),s=document.getElementById("site-search-default"),e=document.getElementById("site-search-results-list"),d=document.querySelectorAll("[data-close-search]"),h=document.querySelectorAll("[data-open-search]");if(!t)return;document.body.appendChild(t);let l=!1;function u(){if(l)return;fetch("/search-index.json").then(e=>e.json()).then(e=>{i=e.documents,l=!0}).catch(e=>console.error("Failed to load search index:",e))}function r(){u(),t.style.display="flex",document.body.style.overflow="hidden",setTimeout(()=>{n.focus(),n.value.trim()?c(n.value):(s.style.display="block",e.style.display="none")},50)}function a(){t.style.display="none",document.body.style.overflow="",n.value="",e.innerHTML="",s.style.display="block",e.style.display="none"}h.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),r()})}),d.forEach(e=>{e.addEventListener("click",a)});function c(t){if(!i)return;if(!t.trim()){s.style.display="block",e.style.display="none",e.innerHTML="";return}s.style.display="none",e.style.display="block",t=t.toLowerCase();const n=i.filter(e=>{const n=e.content.toLowerCase(),s=e.title.toLowerCase(),o=(e.tags||[]).join(" ").toLowerCase();return n.includes(t)||s.includes(t)}).slice(0,15);n.length===0?e.innerHTML='<p class="site-search-no-results">No results found.</p>':e.innerHTML=n.map(e=>`
        <a href="${e.url}" class="site-search-result">
          <div class="site-search-result-title">${e.title}</div>
          <div class="site-search-result-preview">${e.preview}</div>
          <div class="site-search-result-meta">
            <span class="site-search-badge-category">${e.category}</span>
            ${e.tags.map(e=>`<span class="site-search-badge">${e}</span>`).join("")}
          </div>
        </a>
      `).join("")}n.addEventListener("input",function(e){o&&clearTimeout(o),o=setTimeout(()=>{c(e.target.value)},300)}),document.addEventListener("keydown",function(e){(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),t.style.display==="none"||t.style.display===""?r():a()),e.key==="Escape"&&t.style.display==="flex"&&a()})})</script><script>document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll(".pseudocode-toggle"),n=document.querySelectorAll(".pseudocode-modal-close"),s=document.querySelectorAll(".pseudocode-modal-overlay");function o(e){const t=document.getElementById(e);if(!t)return;t.classList.add("active"),t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const n=t.querySelector(".pseudocode-modal-close");n&&n.focus()}function e(e){if(!e)return;e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="";const t=document.querySelector(`.pseudocode-toggle[aria-controls="${e.id}"]`);t&&t.focus()}t.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("aria-controls");o(t)})}),n.forEach(t=>{t.addEventListener("click",t=>{const n=t.target.closest(".pseudocode-modal");e(n)})}),s.forEach(t=>{t.addEventListener("click",t=>{const n=t.target.closest(".pseudocode-modal");e(n)})}),document.addEventListener("keydown",t=>{if(t.key==="Escape"){const t=document.querySelector(".pseudocode-modal.active");t&&e(t)}})})</script><script src=/js/mermaid.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){window.mermaid&&mermaid.initialize({startOnLoad:!0,theme:"base",securityLevel:"loose",themeVariables:{primaryColor:"#f3f4f6",primaryTextColor:"#0f1724",primaryBorderColor:"#2563eb",lineColor:"#6b7280",secondBkgColor:"#ffffff",tertiaryTextColor:"#6b7280",tertiaryColor:"#e6e9ee",noteBkgColor:"#f0f9ff",noteBorderColor:"#2563eb",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},flowchart:{useMaxWidth:!0,curve:"linear"},sequence:{useMaxWidth:!0},gantt:{useWidth:0[0]}});var e=document.getElementById("theme-toggle");e&&e.addEventListener("click",function(){var e=document.documentElement.getAttribute("data-theme")==="dark";document.documentElement.setAttribute("data-theme",e?"":"dark");try{localStorage.setItem("theme",e?"light":"dark")}catch{}})})</script></body></html>