<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Service Resilience - Systology</title><meta name=description content="Idempotency, circuit breakers, async IO, and background job patterns."><link rel=canonical href=https://sambyte.net/systology/principles/service-resilience/><link rel=icon href=/systology/favicon.svg type=image/svg+xml><meta name=robots content="index, follow"><meta property="og:site_name" content="Systology"><meta property="og:title" content="Service Resilience - Systology"><meta property="og:description" content="Idempotency, circuit breakers, async IO, and background job patterns."><meta property="og:url" content="https://sambyte.net/systology/principles/service-resilience/"><meta property="og:type" content="article"><meta property="article:modified_time" content="2026-02-27T15:30:24-08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Service Resilience - Systology"><meta name=twitter:description content="Idempotency, circuit breakers, async IO, and background job patterns."><script data-cfasync=false>try{localStorage.getItem("theme")==="dark"&&(document.documentElement.setAttribute("data-theme","dark"),document.documentElement.style.colorScheme="dark")}catch{}</script><style>:root{color-scheme:light;--bg:#ffffff;--text:#0f1724;--muted:#6b7280;--accent:#2563eb;--accent-weak:rgba(37, 99, 235, 0.08);--accent-weak-up:rgba(37, 99, 235, 0.15);--border:#e6e9ee;--blockquote-bg:#f8fafc;--radius:10px;--max-width:48rem;--focus:3px rgba(37, 99, 235, 0.18);--link-gap:0.5rem;--gutter:0.75rem;--color-warning:#d97706;--color-success:#059669;--space-nano:0.05rem;--space-micro:0.125rem;--space-xs:0.25rem;--space-xs-plus:0.35rem;--space-sm:0.5rem;--space-sm-plus:0.625rem;--space-md:0.75rem;--space-md-plus:0.875rem;--space-lg:1rem;--space-lg-plus:1.1rem;--space-xl:1.25rem;--space-2xl:1.5rem;--space-3xl:2rem;--space-3xl-plus:2.25rem;--space-4xl:2.5rem}[data-theme=dark]{color-scheme:dark;--bg:#0f1724;--text:#e2e8f0;--muted:#94a3b8;--accent:#60a5fa;--accent-weak:rgba(96, 165, 250, 0.1);--accent-weak-up:rgba(96, 165, 250, 0.2);--border:#1e293b;--blockquote-bg:#1a2332;--focus:3px rgba(96, 165, 250, 0.25);--color-warning:#fbbf24;--color-success:#34d399}html{scrollbar-gutter:stable}*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif;line-height:1.75;font-size:16px;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;overflow-anchor:none;min-height:100svh;display:grid;grid-template-rows:auto 1fr auto}.container{width:100%;max-width:var(--max-width);margin:0 auto;padding:0 var(--gutter)}main.container{padding-top:var(--space-lg);padding-bottom:var(--space-2xl)}:focus-visible{outline:var(--focus);outline-offset:var(--space-xs)}.theme-toggle{display:inline-flex;align-items:center;justify-content:center;width:var(--space-3xl);height:var(--space-3xl);padding:0;border:1px solid var(--border);border-radius:8px;background:0 0;color:var(--muted);cursor:pointer}.theme-toggle:hover,.theme-toggle:focus-visible{color:var(--accent);border-color:var(--accent);background:var(--accent-weak)}.theme-toggle svg{width:var(--space-lg-plus);height:var(--space-lg-plus)}.theme-toggle .icon-sun{display:none}.theme-toggle .icon-moon{display:block}[data-theme=dark] .theme-toggle .icon-sun{display:block}[data-theme=dark] .theme-toggle .icon-moon{display:none}.pagination{display:flex;justify-content:center;gap:var(--space-lg);margin:var(--space-3xl)0 var(--space-lg)}.pagination a{display:inline-flex;align-items:center;padding:var(--space-sm)var(--space-xl);border:1px solid var(--border);border-radius:6px;color:var(--accent);text-decoration:none;font-size:.95rem;font-weight:500}.pagination a:hover,.pagination a:focus-visible{background:var(--accent-weak);border-color:var(--accent);box-shadow:0 2px 8px rgba(37,99,235,8%)}.card,.post-card{background:linear-gradient(0deg,rgba(0,0,0,1%),rgba(0,0,0,1%));border:1px solid var(--border);border-radius:12px}.card{padding:var(--space-lg)}.post-card{padding:var(--space-xl);display:flex;flex-direction:column;gap:var(--space-md)}.post-card h3{margin:0;font-size:1.1rem;line-height:1.3}.post-card h3 a{text-decoration:none}.post-card h3 a:hover{text-decoration:underline}.post-card .summary{margin:0;color:var(--text);font-size:.95rem;line-height:1.5}.posts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:var(--space-2xl);margin:var(--space-2xl)0}.badge{display:inline-flex;align-items:center;gap:var(--space-xs);padding:var(--space-xs).625rem;background:var(--accent-weak);border:1px solid rgba(37,99,235,.2);border-radius:6px;color:var(--accent);text-decoration:none;font-size:.9rem;font-weight:500}.title-group{display:flex;align-items:center;flex-wrap:wrap;gap:var(--space-lg)}.title-group>*{margin:var(--space-sm)0}.title-group .draft-badge,.title-group .link-pill{font-size:.75rem}.badge:hover,.badge:focus{background:rgba(37,99,235,.15);border-color:var(--accent)}.draft-badge{display:inline-flex;align-items:center;padding:var(--space-micro)var(--space-sm);background:rgba(217,119,6,.1);border:1px solid rgba(217,119,6,.3);border-radius:4px;color:var(--color-warning);font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em}[data-theme=dark] .draft-badge{background:rgba(251,191,36,.1);border-color:rgba(251,191,36,.3)}.link-pill{display:inline-flex;align-items:center;padding:var(--space-micro)var(--space-sm);background:var(--accent-weak);border:1px solid rgba(37,99,235,.2);border-radius:4px;color:var(--accent);text-decoration:none;font-size:.75rem;font-weight:700;letter-spacing:.05em}.link-pill:hover,.link-pill:focus{background:rgba(37,99,235,.15);border-color:var(--accent)}.term-pill{display:inline-flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm)var(--space-md-plus);background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);text-decoration:none;color:var(--text);font-size:.95rem;font-weight:500}.term-pill:hover,.term-pill:focus-visible{border-color:var(--accent);background:var(--accent-weak);transform:translateY(-1px);box-shadow:0 4px 12px rgba(37,99,235,8%)}.term-pill .count{font-size:.8rem;background:var(--bg);color:var(--muted);padding:var(--space-micro)var(--space-sm);border-radius:6px;border:1px solid var(--border)}.term-pill:hover .count{border-color:rgba(37,99,235,.2);color:var(--accent)}.terms-pills{display:flex;flex-wrap:wrap;gap:var(--space-md);margin:var(--space-3xl)0}.label-tag,.label-cat{padding:var(--space-nano)var(--space-xs-plus);border-radius:4px;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.02em}.label-tag{background:var(--accent-weak);color:var(--accent);border:1px solid rgba(37,99,235,.2)}.label-cat{background:rgba(5,150,105,.1);color:var(--color-success);border:1px solid rgba(5,150,105,.2)}[data-theme=dark] .label-cat{background:rgba(52,211,153,.1);border:1px solid rgba(52,211,153,.2)}.prose h1{font-size:2rem;line-height:1.05}.prose h2{font-size:1.5rem}.prose h3{font-size:1.15rem}.prose p{margin:.6rem 0}.prose ul,.prose ol{margin:var(--space-md)0}.prose li{margin-bottom:var(--space-sm);padding-left:var(--space-xs)}.prose a{color:var(--accent);text-decoration:underline;text-underline-offset:3px}.prose a.term-pill{text-decoration:none}.prose img{max-width:100%;height:auto;border-radius:8px;display:block;margin:var(--space-md)0}code{background:rgba(37,99,235,8%);padding:.15rem var(--space-xs-plus);border-radius:6px;border:1px solid rgba(37,99,235,.15);font-size:.94em;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,roboto mono,courier new,monospace}pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,roboto mono,courier new,monospace;padding:var(--space-lg);border-radius:var(--radius);background:var(--bg);border:1px solid var(--border);color:var(--text);overflow:auto;margin:var(--space-lg)0;box-shadow:0 2px 8px rgba(0,0,0,4%)}pre code{background:0 0;padding:0;color:inherit;border:none}[data-theme=dark] pre{background:var(--blockquote-bg);border-color:var(--border);color:var(--text)}[data-theme=dark] code{background:var(--accent-weak);border-color:var(--accent-weak-up)}blockquote{margin:var(--space-lg)0;padding:.6rem var(--space-lg);border-left:4px solid var(--border);background:var(--blockquote-bg);color:var(--muted);border-radius:6px}table{width:100%;border-collapse:collapse;margin:var(--space-lg)0;font-size:.95rem}th,td{padding:var(--space-sm).75rem;border-bottom:1px solid var(--border);text-align:left}th{color:var(--muted);font-weight:600}.site-header{border-bottom:1px solid var(--border);background:0 0}.site-header .container{display:flex;align-items:center;justify-content:space-between;gap:var(--space-lg);padding-top:var(--space-lg);padding-bottom:var(--space-lg)}.brand{font-weight:700;font-size:1.125rem;color:var(--text);text-decoration:none;display:flex;align-items:center;gap:var(--space-sm)}.logo-icon{width:1.5rem;height:1.5rem}.site-nav{display:flex;gap:var(--link-gap);align-items:center}.site-nav a{color:var(--muted);text-decoration:none;font-size:.95rem;padding:var(--space-xs).375rem;border-radius:6px}.site-nav a:hover,.site-nav a:focus{color:var(--accent);background:var(--accent-weak);outline:transparent}.site-footer{border-top:1px solid var(--border);color:var(--muted);font-size:.95rem;padding:var(--space-lg)0 var(--space-2xl)}.footer-inner{display:flex;justify-content:space-between;align-items:center;gap:var(--space-lg)}.footer-inner .copyright{margin:0}.social-links{display:flex;gap:var(--space-sm);align-items:center}.social-links a{color:var(--muted);padding:var(--space-xs).375rem;border-radius:6px;display:flex;align-items:center;justify-content:center}.social-links a:hover,.social-links a:focus{color:var(--accent);background:var(--accent-weak);transform:translateY(-1px)}.prose article>header{margin-bottom:var(--space-lg)}.prose article>header h2{margin:.25rem 0 .75rem;font-weight:600;font-size:1.125rem}.prose article>header div.tags{margin:var(--space-sm)0}div.tags{display:flex;flex-wrap:wrap;gap:var(--space-md);align-items:center;margin:var(--space-md)0}div.tags>span{font-weight:600;color:var(--text)}span.muted{margin-left:.125rem}.mermaid{margin:var(--space-2xl)0;padding:var(--space-lg);background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);overflow:auto}.mermaid svg{max-width:100%;height:auto;display:block;margin:0 auto}.mermaid .edgePath .path{stroke:var(--accent);stroke-width:2}.mermaid .flowchart-link{stroke:var(--muted);stroke-width:1.5}.mermaid text{fill:var(--text);font-family:inherit}[data-theme=dark] .mermaid{background:var(--blockquote-bg);border-color:var(--border)}[data-theme=dark] .mermaid .flowchart-link{stroke:var(--text)!important}[data-theme=dark] .mermaid .marker{stroke:var(--text)!important;fill:var(--text)!important}.related{margin-top:var(--space-4xl);padding-top:var(--space-2xl);border-top:1px solid var(--border)}.related h3{font-size:1.05rem;margin:0 0 .75rem;color:var(--muted);font-weight:600;letter-spacing:.02em;text-transform:uppercase}.related ul{list-style:none;padding:0;margin:0;display:grid;gap:var(--space-sm)}.related li{padding:var(--space-sm)0}.related a{font-weight:500;text-decoration:none;color:var(--accent)}.related a:hover{text-decoration:underline}.related .muted{color:var(--muted);font-size:.88rem}.related-type{display:inline-flex;gap:var(--space-sm);margin-left:var(--space-sm);vertical-align:middle}.listing{list-style:none;padding:0;margin:var(--space-2xl)0}.listing li{padding:.625rem 0;border-bottom:1px solid var(--border)}.listing li:last-child{border-bottom:none}.listing a{font-weight:500}.listing .draft-badge{margin-left:var(--space-sm)}.meta{color:var(--muted);font-size:.9rem}@media(max-width:640px){:root{--gutter:var(--space-md)}.brand{font-size:var(--space-lg)}.logo-icon{width:var(--space-xl);height:var(--space-xl)}main.container{padding-top:var(--space-sm);padding-bottom:var(--space-sm)}.footer-inner{flex-direction:column;justify-content:center;gap:var(--space-md)}}@media(min-width:641px) and (max-width:700px){:root{--gutter:var(--space-xl)}}.pseudocode-container{margin:var(--space-lg)0}.pseudocode-toggle{display:inline-flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm)var(--space-lg);background:var(--accent-weak);border:1px solid rgba(37,99,235,.2);border-radius:var(--radius);color:var(--text);font-weight:500;cursor:pointer}.pseudocode-toggle:hover,.pseudocode-toggle:focus-visible{background:var(--accent-weak-up);border-color:var(--accent);transform:translateY(-1px)}[data-theme=dark] .pseudocode-toggle{border:1px solid rgba(96,165,250,.4)}.pseudocode-modal{display:none;position:fixed;inset:0;z-index:1000;align-items:center;justify-content:center}.pseudocode-modal.active{display:flex}.pseudocode-modal-overlay{position:absolute;inset:0;background:rgba(15,23,36,.5);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);transition:opacity .2s ease}[data-theme=dark] .pseudocode-modal-overlay{background:rgba(0,0,0,.6)}.pseudocode-modal-content{position:relative;width:100%;max-width:800px;max-height:85vh;margin:0 var(--space-md);background:var(--bg);border:1px solid var(--border);border-radius:12px;box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,4%);display:flex;flex-direction:column;overflow:hidden;z-index:1001;animation:modalIn .2s cubic-bezier(.16,1,.3,1)}[data-theme=dark] .pseudocode-modal-content{box-shadow:0 20px 25px -5px rgba(0,0,0,.5),0 10px 10px -5px rgba(0,0,0,.25)}@keyframes modalIn{from{opacity:0;transform:scale(.95)translateY(10px)}to{opacity:1;transform:scale(1)translateY(0)}}.pseudocode-modal-header{display:flex;align-items:center;justify-content:space-between;padding:var(--space-md)var(--space-xl);border-bottom:1px solid var(--border);background:var(--bg)}.pseudocode-modal-title{margin:0;font-size:1.1rem;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.pseudocode-modal-close{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:0 0;border:none;border-radius:6px;color:var(--muted);cursor:pointer;padding:0;margin-left:var(--space-md);flex-shrink:0}.pseudocode-modal-close:hover,.pseudocode-modal-close:focus-visible{background:rgba(239,68,68,.1);color:#ef4444}.pseudocode-modal-body{padding:0 var(--space-xl)var(--space-xl);overflow-y:auto;overscroll-behavior:contain;font-size:.85rem}.pseudocode-modal-body pre{margin:var(--space-md)0}.toc{margin:var(--space-2xl)0;padding:var(--space-lg);background:var(--accent-weak);border:1px solid rgba(37,99,235,.1);border-radius:var(--radius)}.toc h3{margin:0 0 var(--space-sm);font-size:.9rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--muted)}.toc nav ul{list-style:none;padding:0;margin:0}.toc nav ul ul{padding-left:var(--space-lg);margin-top:var(--space-xs)}.toc nav li{margin-bottom:var(--space-xs);line-height:1.4}.toc nav a{color:var(--text);text-decoration:none;font-size:.95rem}.toc nav a:hover{color:var(--accent);text-decoration:underline;text-underline-offset:4px}[data-theme=dark] .toc{background:rgba(96,165,250,5%);border-color:rgba(96,165,250,.1)}.bg{color:#fff;background-color:#000}.chroma{color:#fff;background-color:#000;-webkit-text-size-adjust:none}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#191919}.chroma .lnt{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#b6a0ff}.chroma .kc{color:#00bcff}.chroma .kd{color:#b6a0ff}.chroma .kn{color:#b6a0ff}.chroma .kp{color:#b6a0ff}.chroma .kr{color:#b6a0ff}.chroma .kt{color:#6ae4b9}.chroma .nb{color:#f78fe7}.chroma .bp{color:#f78fe7}.chroma .nv{color:#00d3d0}.chroma .vc{color:#00d3d0}.chroma .vg{color:#00d3d0}.chroma .vi{color:#00d3d0}.chroma .vm{color:#00d3d0}.chroma .nf{color:#feacd0}.chroma .fm{color:#feacd0}.chroma .l{color:#00bcff}.chroma .ld{color:#00bcff}.chroma .s{color:#79a8ff}.chroma .sa{color:#79a8ff}.chroma .sb{color:#79a8ff}.chroma .sc{color:#79a8ff}.chroma .dl{color:#79a8ff}.chroma .sd{color:#79a8ff}.chroma .s2{color:#79a8ff}.chroma .se{color:#79a8ff}.chroma .sh{color:#79a8ff}.chroma .si{color:#79a8ff}.chroma .sx{color:#79a8ff}.chroma .sr{color:#79a8ff}.chroma .s1{color:#79a8ff}.chroma .ss{color:#79a8ff}.chroma .m{color:#00bcff}.chroma .mb{color:#00bcff}.chroma .mf{color:#00bcff}.chroma .mh{color:#00bcff}.chroma .mi{color:#00bcff}.chroma .il{color:#00bcff}.chroma .mo{color:#00bcff}.chroma .o{color:#00d3d0}.chroma .ow{color:#00d3d0}.chroma .c{color:#a8a8a8}.chroma .ch{color:#a8a8a8}.chroma .cm{color:#a8a8a8}.chroma .c1{color:#a8a8a8}.chroma .cs{color:#a8a8a8}.chroma .cp{color:#a8a8a8}.chroma .cpf{color:#a8a8a8}</style></head><body><header class=site-header role=banner><div class="container header-inner"><a class=brand href=/systology/ aria-label=Systology><img src=/systology/favicon.svg alt class=logo-icon> Systology</a><nav class=site-nav role=navigation aria-label="Main navigation"><button class=theme-toggle onclick='window.location.href="/systology/tags/"' aria-label=Tags>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
</button>
<button class=theme-toggle onclick='window.location.href="/systology/categories/"' aria-label=Categories>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
</button>
<button class=theme-toggle id=theme-toggle aria-label="Toggle dark mode">
<svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></nav></div></header><main id=content class="container prose"><article><header><div class=title-group><h1>Service Resilience</h1></div><h2>Idempotency, circuit breakers, async IO, and background job patterns.</h2><div class=tags><span>Tags:</span>
<a class=badge href=/systology/tags/distributed-systems/>distributed-systems</a>
<a class=badge href=/systology/tags/networking/>networking</a>
<a class=badge href=/systology/tags/queues/>queues</a></div></header><nav class=toc><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#idempotency>Idempotency</a></li><li><a href=#async--non-blocking-io>Async & Non-blocking IO</a></li><li><a href=#network-resilience>Network Resilience</a></li><li><a href=#background-job-processing>Background Job Processing</a><ul><li><a href=#dead-letter-queues-and-retry-policies>Dead-Letter Queues and Retry Policies</a></li><li><a href=#priority-and-qos>Priority and QoS</a></li></ul></li><li><a href=#monitoring--debugging>Monitoring & Debugging</a></li><li><a href=#local-development--mocking>Local Development & Mocking</a></li><li><a href=#decision-framework>Decision Framework</a></li><li><a href=#decision-framework-1>Decision Framework</a></li><li><a href=#cross-principle-notes>Cross-principle Notes</a></li></ul></nav></nav><section><h2 id=idempotency>Idempotency</h2><p>Design operations to be idempotent using idempotency keys and unique request IDs. Retries are only safe if they can&rsquo;t cause side effects.</p><p>Generate a unique idempotency key per logical operation (UUID or deterministic hash of the operation parameters). Send it with each request. The server checks a short-lived store (Redis with 15-minute TTL) for the key: if found, return the cached response; if not, process the request and cache the result. This makes retries safe for state-changing operations like payments and order creation.</p><p>See the <a href=https://sambyte.net/systology/designs/payment-system/>Payment System</a> design for a production-grade implementation of idempotency in financial transactions.</p><p><strong>Anti-pattern — POST Without Idempotency:</strong> Using POST for state-changing operations without idempotency keys. A network timeout causes the client to retry, and the server processes the request twice—creating duplicate orders, double-charging a credit card, or sending duplicate notifications. Idempotency keys are cheap insurance against expensive duplicates.</p><h2 id=async--non-blocking-io>Async & Non-blocking IO</h2><p>Use async/await patterns for scalability and avoid blocking operations in critical paths. Backpressure handling prevents memory exhaustion under load.</p><p>Async IO shines for workloads with many concurrent connections where most time is spent waiting for IO (network, disk). A single async thread can handle thousands of concurrent connections where a thread-per-connection model would exhaust memory. In Python, use <code>asyncio</code>/<code>aiohttp</code>; in Rust, use <code>tokio</code>; in Go, goroutines provide lightweight concurrency natively.</p><p><strong>Anti-pattern — Async Everything:</strong> Making CPU-bound work async. Async IO helps when threads are waiting on network responses; for CPU-intensive computation (compression, hashing, ML inference), async provides no benefit and adds complexity. Use thread pools for CPU-bound work and async for IO-bound work.</p><h2 id=network-resilience>Network Resilience</h2><p>Implement graceful degradation when optional services fail and use fallbacks and caching for reliability. Test failure scenarios regularly—surprises belong in labs, not production.</p><p>Use the circuit breaker pattern: after N consecutive failures to a downstream service, open the circuit (stop making requests) for a cooldown period, then half-open (try a single request) to see if recovery has occurred. During the open state, serve from cache, return a degraded response, or surface &ldquo;temporarily unavailable&rdquo; to the user rather than timing out on every request.</p><div class=mermaid>stateDiagram-v2
[*] --> Closed
Closed --> Open : N consecutive failures
Open --> HalfOpen : cooldown expires
HalfOpen --> Closed : probe succeeds
HalfOpen --> Open : probe fails
Closed : Closed
note right of Closed : Normal operation
Open : Open
note right of Open : Fail fast — serve cache
HalfOpen : Half-Open
note right of HalfOpen : One probe request</div><p>See the <a href=https://sambyte.net/systology/designs/distributed-cache/>Distributed Cache</a> design for how caching provides resilience layers alongside performance.</p><p><strong>Anti-pattern — All-or-Nothing Dependency:</strong> Treating every downstream service as critical. If the recommendation service is down, should the entire product page fail? Usually not—show the product without recommendations. Classify dependencies as critical (payment must succeed) vs. optional (recommendations are nice-to-have) and degrade gracefully for optional ones.</p><h2 id=background-job-processing>Background Job Processing</h2><p>Use pull-based workers with visibility timeouts and idempotency keys for reliable async task execution. Separate queue backends, retry policies, and DLQ handling from application logic.</p><p>Pull-based workers (vs. push-based) give you natural backpressure: workers consume at their own pace and the queue buffers the difference. Visibility timeouts prevent tasks from being lost if a worker crashes mid-execution—the task reappears in the queue after the timeout expires and is picked up by another worker. Pair this with a heartbeat mechanism: long-running workers periodically extend the timeout to signal liveness, preventing premature redelivery.</p><p>For idempotency, key each job write on a stable <code>(owner_id, operation_hash)</code> combination so client retries during network timeouts don&rsquo;t enqueue duplicate jobs. Persist deduplication keys to a database rather than an in-process cache so restarts don&rsquo;t lose them.</p><p>See the <a href=https://sambyte.net/systology/principles/algorithms-performance/>Algorithms & Performance</a> principles for worker sizing and parallelism tuning guidance.</p><p><strong>Anti-pattern — Fire-and-Forget Enqueue:</strong> Treating job submission as a best-effort operation with no deduplication and no status visibility. When the client retries after a timeout, the job runs twice. When it silently fails, no one knows. Always confirm enqueue, track job status in a backing store, and surface failures.</p><h3 id=dead-letter-queues-and-retry-policies>Dead-Letter Queues and Retry Policies</h3><p>Route jobs to a Dead-Letter Queue (DLQ) after a configurable number of retries with exponential backoff and jitter. The DLQ is not a graveyard—it&rsquo;s an inspection queue that enables informed replay or discard decisions.</p><p>Use backoff: <code>delay = min(base × 2^attempt + jitter, max_delay)</code> (e.g., 5s base, 5-minute cap, ±25% jitter). Jitter prevents synchronized retry storms when a downstream dependency recovers. After max retries (3–5 for most workloads), move the message to the DLQ with a full context envelope: original payload, error log, attempt count, and timestamps. Alert on DLQ depth—sustained DLQ growth signals a systemic failure, not transient errors.</p><p><strong>Anti-pattern — Silent Discard:</strong> Dropping jobs that have failed N times without routing them to a DLQ or alerting. From the system&rsquo;s perspective, the job completed. From the user&rsquo;s perspective, nothing happened. DLQs are the difference between &ldquo;this job failed and we know why&rdquo; and &ldquo;something went wrong and we have no idea what.&rdquo;</p><h3 id=priority-and-qos>Priority and QoS</h3><p>Use dedicated queues per job type or priority tier rather than a single shared queue. This prevents batch workloads from starving latency-sensitive jobs.</p><p>For example: a <code>high_priority</code> queue for user-initiated requests (must start within 30s), a <code>default</code> queue for system-triggered jobs (must start within 5 min), and a <code>batch</code> queue for overnight analytics (best-effort). Workers for the <code>high_priority</code> queue should never be saturated by batch work. Token-bucket rate limiters on queue admission protect downstream services from burst overload.</p><h2 id=monitoring--debugging>Monitoring & Debugging</h2><p>Log request/response metadata (status codes, latencies) and emit metrics for success/failure rates. Distributed tracing reveals cross-service latency problems.</p><p>For every outbound HTTP call, log: method, URL (without query params containing secrets), status code, and duration. Emit metrics: <code>http_client_requests_total{method, host, status}</code> and <code>http_client_request_duration_seconds{method, host}</code>. Use these to build dashboards that show error rates and latency percentiles per downstream dependency.</p><p>See the <a href=https://sambyte.net/systology/principles/monitoring/>Monitoring & Observability</a> principles for comprehensive guidance on structured logging, tracing, and alerting.</p><h2 id=local-development--mocking>Local Development & Mocking</h2><p>Provide mock servers and environment-based config to switch backends. Integration tests validate contract compliance without external dependencies.</p><p>Use tools like WireMock (Java), <code>responses</code> (Python), or <code>nock</code> (Node.js) to stub external APIs in tests. For local development, provide a Docker Compose setup that spins up mock versions of downstream services. Use environment-based configuration to switch between real and mock backends: <code>PAYMENT_SERVICE_URL=http://localhost:8081</code> in development vs. the real endpoint in production.</p><p><strong>Anti-pattern — Testing Against Production APIs:</strong> Running integration tests against real external services. This is slow, flaky (dependent on external availability), expensive (some APIs charge per call), and dangerous (you might accidentally create real orders or send real notifications). Use mocks and contract tests locally, and reserve real API testing for a staging environment with sandboxed accounts.</p><h2 id=decision-framework>Decision Framework</h2><p>Choose your resilience pattern based on the failure mode you&rsquo;re designing against:</p><table><thead><tr><th style=text-align:left>If you need&mldr;</th><th style=text-align:left>&mldr;choose this</th><th style=text-align:left>because&mldr;</th></tr></thead><tbody><tr><td style=text-align:left><strong>Safe Retries</strong></td><td style=text-align:left>Idempotency Keys</td><td style=text-align:left>State-changing retries converge without side effects.</td></tr><tr><td style=text-align:left><strong>Fault Isolation</strong></td><td style=text-align:left>Circuit Breaker</td><td style=text-align:left>Stops cascading failure; restores automatically after cooldown.</td></tr><tr><td style=text-align:left><strong>Throughput under Load</strong></td><td style=text-align:left>Async / Non-blocking IO</td><td style=text-align:left>One thread handles thousands of concurrent IO-bound requests.</td></tr><tr><td style=text-align:left><strong>Reliable Async Tasks</strong></td><td style=text-align:left>Pull Workers + DLQ</td><td style=text-align:left>Natural backpressure; failed jobs are inspectable, not silently dropped.</td></tr><tr><td style=text-align:left><strong>Priority Isolation</strong></td><td style=text-align:left>Dedicated Queues per Tier</td><td style=text-align:left>Prevents batch work from starving latency-sensitive jobs.</td></tr></tbody></table><p><strong>Decision Heuristic:</strong> &ldquo;Choose <strong>idempotency first</strong>, then <strong>circuit breakers</strong> at service boundaries, then <strong>dedicated queues</strong> for async work. Any retryable operation without idempotency is a latent duplicate bug.&rdquo;</p><h2 id=decision-framework-1>Decision Framework</h2><p>Use this section to provide a clear heuristic or trade-off matrix for the principle. This should help the reader make a choice based on their specific constraints.</p><table><thead><tr><th style=text-align:left>If you need&mldr;</th><th style=text-align:left>&mldr;choose this</th><th style=text-align:left>because&mldr;</th></tr></thead><tbody><tr><td style=text-align:left><strong>Constraint A</strong></td><td style=text-align:left>Option 1</td><td style=text-align:left>Benefit/Trade-off</td></tr><tr><td style=text-align:left><strong>Constraint B</strong></td><td style=text-align:left>Option 2</td><td style=text-align:left>Benefit/Trade-off</td></tr></tbody></table><p><strong>Decision Heuristic:</strong> &ldquo;Choose <strong>[Tactic]</strong> when <strong>[Context]</strong> is more important than <strong>[Alternative]</strong>.&rdquo;</p><h2 id=cross-principle-notes>Cross-principle Notes</h2><p>Optionally, relate multiple principles to each other or reference other pages in the site that go deeper for a production example of this principle in practice.</p></section><aside class=related><h3>Related</h3><ul><li><a href=/systology/deep-dives/chowist/>Chowist</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Monolithic Django app for place listings; focus on production hardening: static serving, background jobs, connection pooling, and CI/CD.</small></li><li><a href=/systology/designs/distributed-cache/>Distributed Caching Layer for VCS</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Design a distributed cache to reduce I/O and speed up VCS operations by caching objects and hashes with high concurrency and low latency.</small></li><li><a href=/systology/designs/web-crawler/>Distributed Web Crawler</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Design for a Google-scale web crawler focusing on Breadth-First Search (BFS), DNS resolution caching, robots.txt politeness, and handling duplicate or malicious domains.</small></li><li><a href=/systology/designs/migration-dedup/>End-to-End Migration & Deduplication</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>System design for migrating large datasets with deduplication, integrity checks, resumability, and idempotence.</small></li></ul></aside></article></main><footer class=site-footer role=contentinfo><div class="container footer-inner"><p class=copyright>&copy; 2026 Systology. All rights reserved.</p><div class=social-links><a href=/systology/index.xml aria-label="RSS Feed"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg>
</a><a href=/systology/sitemap.xml aria-label=Sitemap><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
</a><a href=https://github.com/huangsam target=_blank rel="noopener noreferrer" aria-label=GitHub><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=http://linkedin.com/in/sambyte target=_blank rel="noopener noreferrer" aria-label=LinkedIn><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></div></div></footer><script>document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll(".pseudocode-toggle"),n=document.querySelectorAll(".pseudocode-modal-close"),s=document.querySelectorAll(".pseudocode-modal-overlay");function o(e){const t=document.getElementById(e);if(!t)return;t.classList.add("active"),t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const n=t.querySelector(".pseudocode-modal-content");n&&(n.setAttribute("tabindex","-1"),n.focus())}function e(e){if(!e)return;e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="";const t=document.querySelector(`.pseudocode-toggle[aria-controls="${e.id}"]`);t&&t.focus()}t.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("aria-controls");o(t)})}),n.forEach(t=>{t.addEventListener("click",t=>{const n=t.target.closest(".pseudocode-modal");e(n)})}),s.forEach(t=>{t.addEventListener("click",t=>{const n=t.target.closest(".pseudocode-modal");e(n)})}),document.addEventListener("keydown",t=>{if(t.key==="Escape"){const t=document.querySelector(".pseudocode-modal.active");t&&e(t)}})})</script><script src=/systology/js/mermaid.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){window.mermaid&&mermaid.initialize({startOnLoad:!0,theme:"base",securityLevel:"loose",themeVariables:{primaryColor:"#f3f4f6",primaryTextColor:"#0f1724",primaryBorderColor:"#2563eb",lineColor:"#6b7280",secondBkgColor:"#ffffff",tertiaryTextColor:"#6b7280",tertiaryColor:"#e6e9ee",noteBkgColor:"#f0f9ff",noteBorderColor:"#2563eb",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},flowchart:{useMaxWidth:!0,curve:"linear"},sequence:{useMaxWidth:!0},gantt:{useWidth:0[0]}});var e=document.getElementById("theme-toggle");e&&e.addEventListener("click",function(){var e=document.documentElement.getAttribute("data-theme")==="dark";document.documentElement.setAttribute("data-theme",e?"":"dark");try{localStorage.setItem("theme",e?"light":"dark")}catch{}})})</script></body></html>