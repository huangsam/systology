<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Beam Trial - Systology</title><meta name=description content="Apache Beam for unified batch/streaming pipelines."><link rel=canonical href=https://sambyte.net/systology/deep-dives/beam-trial/><link rel=icon href=/systology/favicon.svg type=image/svg+xml><meta name=robots content="index, follow"><script>try{localStorage.getItem("theme")==="dark"&&(document.documentElement.setAttribute("data-theme","dark"),document.documentElement.style.colorScheme="dark")}catch{}</script><style>:root{color-scheme:light;--bg:#ffffff;--text:#0f1724;--muted:#6b7280;--accent:#2563eb;--accent-weak:rgba(37, 99, 235, 0.08);--accent-weak-up:rgba(37, 99, 235, 0.15);--border:#e6e9ee;--blockquote-bg:#f8fafc;--radius:10px;--max-width:48rem;--focus:3px rgba(37, 99, 235, 0.18);--link-gap:0.5rem;--gutter:0.75rem;--color-warning:#d97706;--color-success:#059669;--transition:none;--transition-long:none;--space-nano:0.05rem;--space-micro:0.125rem;--space-xs:0.25rem;--space-xs-plus:0.35rem;--space-sm:0.5rem;--space-sm-plus:0.625rem;--space-md:0.75rem;--space-md-plus:0.875rem;--space-lg:1rem;--space-lg-plus:1.1rem;--space-xl:1.25rem;--space-2xl:1.5rem;--space-3xl:2rem;--space-3xl-plus:2.25rem;--space-4xl:2.5rem}[data-theme=dark]{color-scheme:dark;--bg:#0f1724;--text:#e2e8f0;--muted:#94a3b8;--accent:#60a5fa;--accent-weak:rgba(96, 165, 250, 0.1);--accent-weak-up:rgba(96, 165, 250, 0.2);--border:#1e293b;--blockquote-bg:#1a2332;--focus:3px rgba(96, 165, 250, 0.25);--color-warning:#fbbf24;--color-success:#34d399}*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif;line-height:1.75;font-size:16px;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;overflow-anchor:none;min-height:100svh;display:grid;grid-template-rows:auto 1fr auto}.container{width:100%;max-width:var(--max-width);margin:0 auto;padding:0 var(--gutter)}main.container{padding-top:var(--space-lg);padding-bottom:var(--space-2xl)}:focus-visible{outline:var(--focus);outline-offset:var(--space-xs)}.theme-toggle{display:inline-flex;align-items:center;justify-content:center;width:var(--space-3xl);height:var(--space-3xl);padding:0;border:1px solid var(--border);border-radius:8px;background:0 0;color:var(--muted);cursor:pointer}.theme-toggle:hover,.theme-toggle:focus-visible{color:var(--accent);border-color:var(--accent);background:var(--accent-weak)}.theme-toggle svg{width:var(--space-lg-plus);height:var(--space-lg-plus)}.theme-toggle .icon-sun{display:none}.theme-toggle .icon-moon{display:block}[data-theme=dark] .theme-toggle .icon-sun{display:block}[data-theme=dark] .theme-toggle .icon-moon{display:none}.pagination{display:flex;justify-content:center;gap:var(--space-lg);margin:var(--space-3xl)0 var(--space-lg)}.pagination a{display:inline-flex;align-items:center;padding:var(--space-sm)var(--space-xl);border:1px solid var(--border);border-radius:6px;color:var(--accent);text-decoration:none;font-size:.95rem;font-weight:500}.pagination a:hover,.pagination a:focus-visible{background:var(--accent-weak);border-color:var(--accent);box-shadow:0 2px 8px rgba(37,99,235,8%)}.card,.post-card{background:linear-gradient(0deg,rgba(0,0,0,1%),rgba(0,0,0,1%));border:1px solid var(--border);border-radius:12px}.card{padding:var(--space-lg)}.post-card{padding:var(--space-xl);display:flex;flex-direction:column;gap:var(--space-md)}.post-card h3{margin:0;font-size:1.1rem;line-height:1.3}.post-card h3 a{text-decoration:none}.post-card h3 a:hover{text-decoration:underline}.post-card .summary{margin:0;color:var(--text);font-size:.95rem;line-height:1.5}.posts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:var(--space-2xl);margin:var(--space-2xl)0}.badge{display:inline-flex;align-items:center;gap:var(--space-xs);padding:var(--space-xs).625rem;background:var(--accent-weak);border:1px solid rgba(37,99,235,.2);border-radius:6px;color:var(--accent);text-decoration:none;font-size:.9rem;font-weight:500}.title-group{display:flex;align-items:center;flex-wrap:wrap;gap:var(--space-lg)}.title-group>*{margin:var(--space-sm)0}.title-group .draft-badge,.title-group .link-pill{font-size:.75rem}.badge:hover,.badge:focus{background:rgba(37,99,235,.15);border-color:var(--accent)}.draft-badge{display:inline-flex;align-items:center;padding:var(--space-micro)var(--space-sm);background:rgba(217,119,6,.1);border:1px solid rgba(217,119,6,.3);border-radius:4px;color:var(--color-warning);font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em}[data-theme=dark] .draft-badge{background:rgba(251,191,36,.1);border-color:rgba(251,191,36,.3)}.link-pill{display:inline-flex;align-items:center;padding:var(--space-micro)var(--space-sm);background:var(--accent-weak);border:1px solid rgba(37,99,235,.2);border-radius:4px;color:var(--accent);text-decoration:none;font-size:.75rem;font-weight:700;letter-spacing:.05em}.link-pill:hover,.link-pill:focus{background:rgba(37,99,235,.15);border-color:var(--accent)}.term-pill{display:inline-flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm)var(--space-md-plus);background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);text-decoration:none;color:var(--text);font-size:.95rem;font-weight:500}.term-pill:hover,.term-pill:focus-visible{border-color:var(--accent);background:var(--accent-weak);transform:translateY(-1px);box-shadow:0 4px 12px rgba(37,99,235,8%)}.term-pill .count{font-size:.8rem;background:var(--bg);color:var(--muted);padding:var(--space-micro)var(--space-sm);border-radius:6px;border:1px solid var(--border)}.term-pill:hover .count{border-color:rgba(37,99,235,.2);color:var(--accent)}.terms-pills{display:flex;flex-wrap:wrap;gap:var(--space-md);margin:var(--space-3xl)0}.label-tag,.label-cat{padding:var(--space-nano)var(--space-xs-plus);border-radius:4px;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.02em}.label-tag{background:var(--accent-weak);color:var(--accent);border:1px solid rgba(37,99,235,.2)}.label-cat{background:rgba(5,150,105,.1);color:var(--color-success);border:1px solid rgba(5,150,105,.2)}[data-theme=dark] .label-cat{background:rgba(52,211,153,.1);border:1px solid rgba(52,211,153,.2)}.prose h1{font-size:2rem;line-height:1.05}.prose h2{font-size:1.5rem}.prose h3{font-size:1.15rem}.prose p{margin:.6rem 0}.prose ul,.prose ol{margin:var(--space-md)0}.prose li{margin-bottom:var(--space-sm);padding-left:var(--space-xs)}.prose a{color:var(--accent);text-decoration:underline;text-underline-offset:3px}.prose a.term-pill{text-decoration:none}.prose img{max-width:100%;height:auto;border-radius:8px;display:block;margin:var(--space-md)0}code{background:rgba(37,99,235,8%);padding:.15rem var(--space-xs-plus);border-radius:6px;border:1px solid rgba(37,99,235,.15);font-size:.94em;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,roboto mono,courier new,monospace}pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,roboto mono,courier new,monospace;padding:var(--space-lg);border-radius:var(--radius);background:var(--bg);border:1px solid var(--border);color:var(--text);overflow:auto;margin:var(--space-lg)0;box-shadow:0 2px 8px rgba(0,0,0,4%)}pre code{background:0 0;padding:0;color:inherit;border:none}[data-theme=dark] pre{background:var(--blockquote-bg);border-color:var(--border);color:var(--text)}[data-theme=dark] code{background:var(--accent-weak);border-color:var(--accent-weak-up)}blockquote{margin:var(--space-lg)0;padding:.6rem var(--space-lg);border-left:4px solid var(--border);background:var(--blockquote-bg);color:var(--muted);border-radius:6px}table{width:100%;border-collapse:collapse;margin:var(--space-lg)0;font-size:.95rem}th,td{padding:var(--space-sm).75rem;border-bottom:1px solid var(--border);text-align:left}th{color:var(--muted);font-weight:600}.site-header{border-bottom:1px solid var(--border);background:0 0}.site-header .container{display:flex;align-items:center;justify-content:space-between;gap:var(--space-lg);padding-top:var(--space-lg);padding-bottom:var(--space-lg)}.brand{font-weight:700;font-size:1.125rem;color:var(--text);text-decoration:none;display:flex;align-items:center;gap:var(--space-sm)}.logo-icon{width:1.5rem;height:1.5rem}.site-nav{display:flex;gap:var(--link-gap);align-items:center}.site-nav a{color:var(--muted);text-decoration:none;font-size:.95rem;padding:var(--space-xs).375rem;border-radius:6px}.site-nav a:hover,.site-nav a:focus{color:var(--accent);background:var(--accent-weak);outline:transparent}.site-footer{border-top:1px solid var(--border);color:var(--muted);font-size:.95rem;padding:var(--space-lg)0 var(--space-2xl)}.footer-inner{display:flex;justify-content:space-between;align-items:center;gap:var(--space-lg)}.footer-inner .copyright{margin:0}.social-links{display:flex;gap:var(--space-sm);align-items:center}.social-links a{color:var(--muted);padding:var(--space-xs).375rem;border-radius:6px;display:flex;align-items:center;justify-content:center}.social-links a:hover,.social-links a:focus{color:var(--accent);background:var(--accent-weak);transform:translateY(-1px)}.prose article>header{margin-bottom:var(--space-lg)}.prose article>header h2{margin:.25rem 0 .75rem;font-weight:600;font-size:1.125rem}.prose article>header div.tags{margin:var(--space-sm)0}div.tags{display:flex;flex-wrap:wrap;gap:var(--space-md);align-items:center;margin:var(--space-md)0}div.tags>span{font-weight:600;color:var(--text)}span.muted{margin-left:.125rem}.mermaid{margin:var(--space-2xl)0;padding:var(--space-lg);background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);overflow:auto}.mermaid svg{max-width:100%;height:auto;display:block;margin:0 auto}.mermaid .edgePath .path{stroke:var(--accent);stroke-width:2}.mermaid .flowchart-link{stroke:var(--muted);stroke-width:1.5}.mermaid text{fill:var(--text);font-family:inherit}[data-theme=dark] .mermaid{background:var(--blockquote-bg);border-color:var(--border)}[data-theme=dark] .mermaid .flowchart-link{stroke:var(--text)!important}[data-theme=dark] .mermaid .marker{stroke:var(--text)!important;fill:var(--text)!important}.related{margin-top:var(--space-4xl);padding-top:var(--space-2xl);border-top:1px solid var(--border)}.related h3{font-size:1.05rem;margin:0 0 .75rem;color:var(--muted);font-weight:600;letter-spacing:.02em;text-transform:uppercase}.related ul{list-style:none;padding:0;margin:0;display:grid;gap:var(--space-sm)}.related li{padding:var(--space-sm)0}.related a{font-weight:500;text-decoration:none;color:var(--accent)}.related a:hover{text-decoration:underline}.related .muted{color:var(--muted);font-size:.88rem}.related-type{display:inline-flex;gap:var(--space-sm);margin-left:var(--space-sm);vertical-align:middle}.listing{list-style:none;padding:0;margin:var(--space-2xl)0}.listing li{padding:.625rem 0;border-bottom:1px solid var(--border)}.listing li:last-child{border-bottom:none}.listing a{font-weight:500}.listing .draft-badge{margin-left:var(--space-sm)}.meta{color:var(--muted);font-size:.9rem}@media(prefers-reduced-motion:reduce){:root{--transition:none;--transition-long:none}}@media(max-width:640px){:root{--gutter:var(--space-md)}.brand{font-size:var(--space-lg)}.logo-icon{width:var(--space-xl);height:var(--space-xl)}main.container{padding-top:var(--space-sm);padding-bottom:var(--space-sm)}.footer-inner{flex-direction:column;justify-content:center;gap:var(--space-md)}}@media(min-width:641px) and (max-width:700px){:root{--gutter:var(--space-xl)}}.pseudocode-container{margin:var(--space-lg)0}.pseudocode-toggle{display:inline-flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm)var(--space-lg);background:var(--accent-weak);border:1px solid rgba(37,99,235,.2);border-radius:var(--radius);color:var(--accent);font-weight:500;cursor:pointer;transition:var(--transition)}.pseudocode-toggle:hover,.pseudocode-toggle:focus-visible{background:var(--accent-weak-up);border-color:var(--accent);transform:translateY(-1px)}[data-theme=dark] .pseudocode-toggle{border:1px solid rgba(96,165,250,.2)}.pseudocode-modal{display:none;position:fixed;inset:0;z-index:1000;align-items:center;justify-content:center}.pseudocode-modal.active{display:flex}.pseudocode-modal-overlay{position:absolute;inset:0;background:rgba(15,23,36,.5);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);transition:opacity .2s ease}[data-theme=dark] .pseudocode-modal-overlay{background:rgba(0,0,0,.6)}.pseudocode-modal-content{position:relative;width:100%;max-width:800px;max-height:85vh;margin:0 var(--space-md);background:var(--bg);border:1px solid var(--border);border-radius:12px;box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,4%);display:flex;flex-direction:column;overflow:hidden;z-index:1001;animation:modalIn .2s cubic-bezier(.16,1,.3,1)}[data-theme=dark] .pseudocode-modal-content{box-shadow:0 20px 25px -5px rgba(0,0,0,.5),0 10px 10px -5px rgba(0,0,0,.25)}@keyframes modalIn{from{opacity:0;transform:scale(.95)translateY(10px)}to{opacity:1;transform:scale(1)translateY(0)}}.pseudocode-modal-header{display:flex;align-items:center;justify-content:space-between;padding:var(--space-md)var(--space-xl);border-bottom:1px solid var(--border);background:var(--bg)}.pseudocode-modal-title{margin:0;font-size:1.1rem;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.pseudocode-modal-close{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:0 0;border:none;border-radius:6px;color:var(--muted);cursor:pointer;padding:0;margin-left:var(--space-md);flex-shrink:0}.pseudocode-modal-close:hover,.pseudocode-modal-close:focus-visible{background:rgba(239,68,68,.1);color:#ef4444}.pseudocode-modal-body{padding:0 var(--space-xl)var(--space-xl);overflow-y:auto;overscroll-behavior:contain;font-size:.85rem}.pseudocode-modal-body pre{margin:var(--space-md)0}.bg{color:#fff;background-color:#000}.chroma{color:#fff;background-color:#000;-webkit-text-size-adjust:none}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#191919}.chroma .lnt{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#b6a0ff}.chroma .kc{color:#00bcff}.chroma .kd{color:#b6a0ff}.chroma .kn{color:#b6a0ff}.chroma .kp{color:#b6a0ff}.chroma .kr{color:#b6a0ff}.chroma .kt{color:#6ae4b9}.chroma .nb{color:#f78fe7}.chroma .bp{color:#f78fe7}.chroma .nv{color:#00d3d0}.chroma .vc{color:#00d3d0}.chroma .vg{color:#00d3d0}.chroma .vi{color:#00d3d0}.chroma .vm{color:#00d3d0}.chroma .nf{color:#feacd0}.chroma .fm{color:#feacd0}.chroma .l{color:#00bcff}.chroma .ld{color:#00bcff}.chroma .s{color:#79a8ff}.chroma .sa{color:#79a8ff}.chroma .sb{color:#79a8ff}.chroma .sc{color:#79a8ff}.chroma .dl{color:#79a8ff}.chroma .sd{color:#79a8ff}.chroma .s2{color:#79a8ff}.chroma .se{color:#79a8ff}.chroma .sh{color:#79a8ff}.chroma .si{color:#79a8ff}.chroma .sx{color:#79a8ff}.chroma .sr{color:#79a8ff}.chroma .s1{color:#79a8ff}.chroma .ss{color:#79a8ff}.chroma .m{color:#00bcff}.chroma .mb{color:#00bcff}.chroma .mf{color:#00bcff}.chroma .mh{color:#00bcff}.chroma .mi{color:#00bcff}.chroma .il{color:#00bcff}.chroma .mo{color:#00bcff}.chroma .o{color:#00d3d0}.chroma .ow{color:#00d3d0}.chroma .c{color:#a8a8a8}.chroma .ch{color:#a8a8a8}.chroma .cm{color:#a8a8a8}.chroma .c1{color:#a8a8a8}.chroma .cs{color:#a8a8a8}.chroma .cp{color:#a8a8a8}.chroma .cpf{color:#a8a8a8}.site-search-modal-container{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999;align-items:flex-start;justify-content:center;padding-top:10vh}.site-search-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);cursor:pointer;animation:searchOverlayIn .2s ease}.site-search-modal{position:relative;background:var(--bg);border-radius:var(--radius);max-width:600px;width:90%;max-height:70vh;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,.3);z-index:10000;animation:searchModalIn .25s ease;overflow:hidden}.site-search-header{padding:var(--space-lg);border-bottom:1px solid var(--border);background:var(--bg)}.site-search-input-wrapper{position:relative;display:flex;align-items:center}.site-search-icon{position:absolute;left:0;color:var(--muted);pointer-events:none;display:flex}.site-search-input{width:100%;padding:var(--space-md)var(--space-md)var(--space-md)var(--space-3xl);font-size:1.1rem;border:none;background:0 0;color:var(--text);outline:none}.site-search-input:focus{box-shadow:none}.site-search-input::placeholder{color:var(--muted)}.site-search-close{background:0 0;border:none;font-size:1.5rem;cursor:pointer;color:var(--muted);padding:var(--space-xs);display:flex;align-items:center;justify-content:center;transition:var(--transition);margin-left:var(--space-sm)}.site-search-close:hover{color:var(--text);background:var(--accent-weak);border-radius:4px}.site-search-body{padding:var(--space-lg);overflow-y:auto;flex:1;max-height:60vh}.site-search-result{display:block;padding:var(--space-md);margin-bottom:var(--space-sm);border-radius:var(--radius);color:inherit;text-decoration:none;transition:var(--transition)}.site-search-result:last-child{margin-bottom:0}.site-search-result:hover,.site-search-result:focus{background-color:var(--bg);background-image:linear-gradient(var(--accent-weak),var(--accent-weak))}.site-search-result-title{font-weight:600;color:var(--accent);margin-bottom:var(--space-xs);font-size:1rem}.site-search-result-preview{color:var(--muted);font-size:.9rem;margin-bottom:var(--space-sm);line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.site-search-result-meta{display:flex;gap:var(--space-xs);flex-wrap:wrap;margin-top:var(--space-sm)}.site-search-badge,.site-search-badge-category{display:inline-block;padding:.15rem .4rem;border-radius:4px;font-size:.7rem;font-weight:500}.site-search-badge{background:var(--accent-weak);color:var(--accent)}.site-search-badge-category{background:var(--accent-weak-up);color:var(--accent);font-weight:600}.site-search-no-results{text-align:center;color:var(--muted);padding:var(--space-lg)}.site-search-default{display:block}.site-search-quick-links{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md)}.site-search-cta{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-md);background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);text-decoration:none;color:var(--text);transition:var(--transition)}.site-search-cta:hover{background:var(--accent-weak);border-color:var(--accent);transform:translateY(-2px)}.site-search-cta-icon{font-size:1.2rem}.site-search-cta-text{font-weight:600;flex:1}.site-search-cta-arrow{color:var(--muted);font-size:.9rem;transition:var(--transition)}.site-search-cta:hover .site-search-cta-arrow{color:var(--accent);transform:translateX(4px)}@keyframes searchOverlayIn{from{opacity:0}to{opacity:1}}@keyframes searchModalIn{from{opacity:0;transform:translateY(-10px)scale(.98)}to{opacity:1;transform:translateY(0)scale(1)}}.search-toggle{display:inline-flex;align-items:center;justify-content:center;width:var(--space-3xl);height:var(--space-3xl);padding:0;border:1px solid var(--border);border-radius:8px;background:0 0;color:var(--muted);cursor:pointer;transition:var(--transition)}.search-toggle:hover,.search-toggle:focus-visible{color:var(--accent);border-color:var(--accent);background:var(--accent-weak)}@media(max-width:640px){.site-search-modal-container{padding-top:0;align-items:flex-start}.site-search-modal{width:100%;height:100%;max-height:100%;max-width:100%;border-radius:0}.site-search-header{padding:var(--space-md)}}</style></head><body><header class=site-header role=banner><div class="container header-inner"><a class=brand href=/systology/ aria-label=Systology><img src=/systology/favicon.svg alt class=logo-icon> Systology</a><nav class=site-nav role=navigation aria-label="Main navigation"><button class=search-toggle data-open-search aria-label=Search>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
</button>
<button class=theme-toggle id=theme-toggle aria-label="Toggle dark mode">
<svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></nav></div></header><main id=content class="container prose"><article><header><div class=title-group><h1>Beam Trial</h1><a class=link-pill href=https://github.com/huangsam/beam-trial target=_blank rel=noopener title="View on GitHub">GH</a></div><h2>Apache Beam for unified batch/streaming pipelines.</h2><div class=tags><span>Tags:</span>
<a class=badge href=/systology/tags/data-pipelines/>data-pipelines</a>
<a class=badge href=/systology/tags/extensibility/>extensibility</a>
<a class=badge href=/systology/tags/streaming/>streaming</a></div></header><section><h2 id=context--motivation>Context & Motivation</h2><p><strong>Context:</strong> <code>beam-trial</code> is a minimal Apache Beam learning project in Java/Gradle that demonstrates fundamental pipeline construction with the DirectRunner. The project provides a single entry point that creates an in-memory <code>PCollection</code>, applies transforms, and writes sharded text output.</p><p><strong>Motivation:</strong> Beam is an alternative to Flink, and I wanted to understand its core programming model and abstractions. The project serves as a simple starting point to learn how to construct pipelines, apply transforms, and execute with the DirectRunner before exploring more complex features like windowing, stateful processing, and runner portability.</p><h2 id=the-local-implementation>The Local Implementation</h2><ul><li><strong>Current Logic:</strong> A Gradle project with a single <code>Main</code> class. The pipeline creates an in-memory <code>PCollection</code> from a small set of words, applies <code>MapElements</code> transforms with a prefixing function, and writes sharded text output via <code>TextIO.write()</code>. The DirectRunner executes the pipeline locally in a single JVM.</li><li><strong>Beam model concepts:</strong> even this minimal example illustrates key Beam abstractions‚Äî<code>PCollection</code> as a logical dataset (bounded or unbounded), <code>PTransform</code> as a composable operation, and <code>Coder</code> for serialization. Understanding these abstractions is essential because they determine how runners execute the graph.</li><li><strong>Bottleneck:</strong> DirectRunner executes transforms sequentially in a single JVM, which masks parallelism and fusion behavior. IO sharding on DirectRunner produces a single shard regardless of configuration, hiding the multi-shard behavior visible on distributed runners. The project is intentionally minimal‚Äîextending it to demonstrate GroupByKey, windowing, and multi-runner support is the natural next step.</li></ul><h2 id=comparison-to-industry-standards>Comparison to Industry Standards</h2><ul><li><strong>My Project:</strong> A teaching-first, minimal Beam example that establishes the core pipeline model. Emphasis on simplicity and a clean starting point for further exploration.</li><li><strong>Industry:</strong> Production Beam pipelines rely on robust runners with monitoring (Dataflow Metrics, Flink Web UI), durable sources/sinks, exactly-once semantics, and orchestration (Airflow, Argo) for scheduling and retry.</li><li><strong>Gap Analysis:</strong> To move from this learning example to production: add additional transforms (GroupByKey, windowed aggregations, side inputs), integrate durable sources/sinks with schema enforcement (Avro/Parquet), implement pipeline-level monitoring and alerting, integrate orchestration for scheduling and failure recovery, and tune runner-specific configurations for the target workload.</li></ul><h2 id=risks--mitigations>Risks & Mitigations</h2><ul><li><strong>Local-only assumptions:</strong> the project currently only demonstrates DirectRunner. Include docs on runner portability and the dependency/config changes required when switching runners. Add Gradle configurations per runner for easy switching.</li><li><strong>Minimal scope limiting learning:</strong> the single-pipeline structure doesn&rsquo;t yet cover GroupByKey, windowing, or side inputs‚Äîfeatures critical for real-world Beam usage. Extend incrementally with documented learning paths.</li><li><strong>Dependency conflicts:</strong> Beam&rsquo;s transitive dependencies (gRPC, Protobuf, Guava) frequently conflict with runner libraries. Pin versions and document known-good dependency sets per runner.</li></ul></section><aside class=related><h3>Related</h3><ul><li><a href=/systology/designs/ad-click-aggregator/>Ad Click Aggregator</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Design for aggregating ad clicks at massive scale, focusing on deduplication, exactly-once processing, and low-latency reporting.</small></li><li><a href=/systology/principles/data-pipelines/>Data Pipelines</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Principles for reliable batch and streaming pipelines: time semantics, fault tolerance, partitioning, observability, and reproducibility.</small></li><li><a href=/systology/designs/web-crawler/>Distributed Web Crawler</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Design for a Google-scale web crawler focusing on Breadth-First Search (BFS), DNS resolution caching, robots.txt politeness, and handling duplicate or malicious domains.</small></li><li><a href=/systology/designs/feature-etl/>ETL Pipeline for ML Features</a>
<span class=related-type><small class=label-tag>tag</small></span><br><small class=muted>Robust ETL pipeline for deterministic, reproducible ML feature generation from diverse sources, with idempotence and scale in mind.</small></li></ul></aside></article></main><footer class=site-footer role=contentinfo><div class="container footer-inner"><p class=copyright>&copy; 2026 Systology. All rights reserved.</p><div class=social-links><a href=https://github.com/huangsam target=_blank rel="noopener noreferrer" aria-label=GitHub><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=http://linkedin.com/in/sambyte target=_blank rel="noopener noreferrer" aria-label=LinkedIn><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></div></div></footer><div id=site-search-modal class=site-search-modal-container style=display:none><div class=site-search-overlay data-close-search></div><div class=site-search-modal><div class=site-search-header><div class=site-search-input-wrapper><span class=site-search-icon><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
</span><input type=text class=site-search-input id=site-search-input placeholder="Search designs, principles, deep dives..." aria-label=Search autocomplete=off>
<button class=site-search-close data-close-search>&#215;</button></div></div><div class=site-search-body><div id=site-search-default class=site-search-default><div class=site-search-quick-links><a href=/systology/categories/ class=site-search-cta><span class=site-search-cta-icon>üìÇ</span>
<span class=site-search-cta-text>All Categories</span>
<span class=site-search-cta-arrow>‚Üí</span>
</a><a href=/systology/tags/ class=site-search-cta><span class=site-search-cta-icon>üè∑Ô∏è</span>
<span class=site-search-cta-text>All Tags</span>
<span class=site-search-cta-arrow>‚Üí</span></a></div></div><div id=site-search-results-list style=display:none></div></div></div></div><script>document.addEventListener("DOMContentLoaded",function(){let i=null,o=null;const t=document.getElementById("site-search-modal"),n=document.getElementById("site-search-input"),s=document.getElementById("site-search-default"),e=document.getElementById("site-search-results-list"),d=document.querySelectorAll("[data-close-search]"),h=document.querySelectorAll("[data-open-search]");if(!t)return;document.body.appendChild(t);let l=!1;function u(){if(l)return;fetch("/systology/search-index.json").then(e=>e.json()).then(e=>{i=e.documents,l=!0}).catch(e=>console.error("Failed to load search index:",e))}function r(){u(),t.style.display="flex",document.body.style.overflow="hidden",setTimeout(()=>{n.focus(),n.value.trim()?c(n.value):(s.style.display="block",e.style.display="none")},50)}function a(){t.style.display="none",document.body.style.overflow="",n.value="",e.innerHTML="",s.style.display="block",e.style.display="none"}h.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),r()})}),d.forEach(e=>{e.addEventListener("click",a)});function c(t){if(!i)return;if(!t.trim()){s.style.display="block",e.style.display="none",e.innerHTML="";return}s.style.display="none",e.style.display="block",t=t.toLowerCase();const n=i.filter(e=>{const n=e.content.toLowerCase(),s=e.title.toLowerCase(),o=(e.tags||[]).join(" ").toLowerCase();return n.includes(t)||s.includes(t)}).slice(0,15);n.length===0?e.innerHTML='<p class="site-search-no-results">No results found.</p>':e.innerHTML=n.map(e=>`
        <a href="${e.url}" class="site-search-result">
          <div class="site-search-result-title">${e.title}</div>
          <div class="site-search-result-preview">${e.preview}</div>
          <div class="site-search-result-meta">
            <span class="site-search-badge-category">${e.category}</span>
            ${e.tags.map(e=>`<span class="site-search-badge">${e}</span>`).join("")}
          </div>
        </a>
      `).join("")}n.addEventListener("input",function(e){o&&clearTimeout(o),o=setTimeout(()=>{c(e.target.value)},300)}),document.addEventListener("keydown",function(e){(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),t.style.display==="none"||t.style.display===""?r():a()),e.key==="Escape"&&t.style.display==="flex"&&a()})})</script><script>document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll(".pseudocode-toggle"),n=document.querySelectorAll(".pseudocode-modal-close"),s=document.querySelectorAll(".pseudocode-modal-overlay");function o(e){const t=document.getElementById(e);if(!t)return;t.classList.add("active"),t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const n=t.querySelector(".pseudocode-modal-close");n&&n.focus()}function e(e){if(!e)return;e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="";const t=document.querySelector(`.pseudocode-toggle[aria-controls="${e.id}"]`);t&&t.focus()}t.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("aria-controls");o(t)})}),n.forEach(t=>{t.addEventListener("click",t=>{const n=t.target.closest(".pseudocode-modal");e(n)})}),s.forEach(t=>{t.addEventListener("click",t=>{const n=t.target.closest(".pseudocode-modal");e(n)})}),document.addEventListener("keydown",t=>{if(t.key==="Escape"){const t=document.querySelector(".pseudocode-modal.active");t&&e(t)}})})</script><script src=/systology/js/mermaid.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){window.mermaid&&mermaid.initialize({startOnLoad:!0,theme:"base",securityLevel:"loose",themeVariables:{primaryColor:"#f3f4f6",primaryTextColor:"#0f1724",primaryBorderColor:"#2563eb",lineColor:"#6b7280",secondBkgColor:"#ffffff",tertiaryTextColor:"#6b7280",tertiaryColor:"#e6e9ee",noteBkgColor:"#f0f9ff",noteBorderColor:"#2563eb",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},flowchart:{useMaxWidth:!0,curve:"linear"},sequence:{useMaxWidth:!0},gantt:{useWidth:0[0]}});var e=document.getElementById("theme-toggle");e&&e.addEventListener("click",function(){var e=document.documentElement.getAttribute("data-theme")==="dark";document.documentElement.setAttribute("data-theme",e?"":"dark");try{localStorage.setItem("theme",e?"light":"dark")}catch{}})})</script></body></html>